name: TV Music Scraper
on:
  schedule:
    - cron: '*/30 * * * *'  # Every 30 minutes
  workflow_dispatch:

jobs:
  scrape:
    runs-on: ubuntu-latest
    timeout-minutes: 20
    
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with: { python-version: '3.11' }
      
      - name: Install system dependencies
        run: sudo apt-get update && sudo apt-get install -y ffmpeg
      
      - name: Install Python dependencies
        run: pip install -r requirements.txt
      
      - name: Run TV Scraper
        env:
          UGBOARD_API_URL: ${{ secrets.UGBOARD_API_URL }}
          INTERNAL_TOKEN: ${{ secrets.INTERNAL_TOKEN }}
          ACRCLOUD_HOST: ${{ secrets.ACRCLOUD_HOST }}
          ACRCLOUD_ACCESS_KEY: ${{ secrets.ACRCLOUD_ACCESS_KEY }}
          ACRCLOUD_ACCESS_SECRET: ${{ secrets.ACRCLOUD_ACCESS_SECRET }}
        run: python scripts/tv_scraper.py
